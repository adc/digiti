
<html>
<head><title>Converting postix &lt;-&gt; infix </head>
<body>
<script src="tree.js" ></script>
<script>
// {PEMDAS} Infix

//TODO: parentheses, functions, exponents, unary operators
//dijkstra'Z shunting-yard,
// haad ik maar en tijdmachine
//infix to postfix converter
function i_to_p(input, output)
{
  postfix = "";
  opstack = [];
  
  for(var idx = 0; idx < input.length; idx++){
    var cur = input.charCodeAt(idx);
    //reading a number
    if(cur >= 48 && cur <= 57)
    {
      while(cur >= 48 && cur <= 57 && idx < input.length){
        postfix += input[idx++];
        cur = input.charCodeAt(idx);
      }
      postfix += " ";
    }

    op = operators.indexOf(input[idx]);
    if(op != -1) {
      while(1) {
        prev = opstack[opstack.length-1];
        if(!prev){
          opstack.push(operators[op]);
          break;
        } else {
          //note: < vs <= here makes a difference
          //for things like 3+3*4+2. 
          //the result will be technically equivalent
          //but not of the preferred form for tree transformations
          if (op < operators.indexOf(prev)) {
            opstack.push(operators[op]);
            break;
          } else {
            postfix += opstack.pop() + " ";
          }
        }
      }
    }
  }

  val = opstack.pop();
  while(val){
    postfix += val + " ";
    val = opstack.pop();
  }
    
  output.innerHTML = postfix;
}


var tree;
function postfix_to_tree(input)
{
  nodestack = [];
  tree = new mathTree();
  
  for(var idx = 0; idx < input.length; idx++){
    var cur = input.charCodeAt(idx);
    //reading a number
    if(cur != 32)
    {
      token = "";
      while(cur != 32 && idx < input.length){
        token += input[idx++];
        cur = input.charCodeAt(idx);
      }
      nodestack.push(token);
    }
  }
  
  tree.buildTree(nodestack, nodestack.length-1);
}


function p_to_i(input, output)
{
  output.innerHTML = input;
}
</script>



<form action="" name="text">
<h3>Infix->Postfix</h3>
<textarea name="input1"></textarea><br />
<input type="button" value="Submit" onclick="javascript:i_to_p(document.text.input1.value, document.getElementById('ret1'));" />

<h3>Postfix->Infix</h3>
<textarea name="input2"></textarea><br />
<input type="button" value="Submit" onclick="javascript:p_to_i(document.text.input2.value, document.getElementById('ret2'));" />
</form>

Infix->Postfix:
<div id="ret1">
</div>

Postfix->Infix
<div id="ret2">
</div>

</body>
</html>
